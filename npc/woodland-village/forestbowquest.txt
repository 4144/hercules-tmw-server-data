//#################################################################################
//#                                                                               #
//# This script file contains the npc scripts for the quest to obtain a forestbow #
//#                                                                               #
//# Needed: 10 Raw Logs, 5000gp, some chatting and running.                       #
//#                                                                               #
//# Reward: Forest Bow                                                            #
//#################################################################################

// Archer Shop Master
new_20-1.gat,99,23,0	script	Master	125, {
	if (QUEST_Forestbow_state == 1) goto L_State_1;
	if (QUEST_Forestbow_state == 2) goto L_State_2;
	if (QUEST_Forestbow_state == 3) goto L_State_3;
	if (QUEST_Forestbow_state == 4) goto L_State_4;
	if (QUEST_Forestbow_state == 5) goto L_State_5;

	mes "[Bowyer Master]";
	mes "When you want to buy something then please speak to my apprentice. I am only doing special requests.";
	next;
	menu "OK, thanks",-,"Can you make me a really good bow?", L_State_0_1;
		close;

	L_State_0_1:
		mes "[Bowyer Master]";
		mes "You mean like one of my legendary forest bows?";
		next;
		menu "Yes, that would be nice.",-;
		mes "Sorry, I am not making these anymore.";
		next;
		menu "Oh, too bad.",-,"What? Why that?", L_State_0_2;
			close;
        L_State_0_2:
        	mes "[Bowyer Master]";
            mes "The problem is that I am short of material. My forestbows are not made of regular wood, you know.";
            mes "They are made of special living wood. And only the best logs of living wood are good enough for them.";
            mes "I used to get these logs from Jack, the lumberjack. But the last time I asked him for a new delivery he said that he would never again get any for me.";
            set QUEST_Forestbow_state, 1;
            next;
            menu "Too bad.",-,"Did you ask him why?", L_State_0_3;
                close;
            L_State_0_3:
            	mes "[Bowyer Master]";
                mes "Sure I did. But he just told me to leave him alone. Maybe you could ask him what's wrong?";
                next;
                menu "OK, I'll ask him.",-,"I am sure he got his reasons.",-;
                close;


	L_State_1:
		mes "[Bowyer Master]";
		mes "Did you already ask Jack why he won't deliver me any more living wood?";
		next;
		menu "No, I haven't had the time yet",-,"No, I didn't find him yet.",L_State_1_1;
			close;
        L_State_1_1:
        	mes "[Bowyer Master]";
            mes "When you leave my shop just go southwest over the village plaza. You can't miss it.";
            close;

	L_State_2:
		mes "[Bowyer Master]";
		mes "Did you already ask Jack why he won't deliver me any more living wood?";
		next;
		menu "Yes, I did. He said that the trees turned into dangerous monsters.",-;
		mes "[Bowyer Master]";
		mes "Oh, that's really bad news. Maybe you can do his job?";
		mes "When you kill some of these tree monsters and bring me their wood I can take a look at them.";
		mes "Maybe you will find a piece of wood that is strong enough to become one of my forest bows.";
		set QUEST_Forestbow_state, 3;
		close;

	L_State_3:
		mes "[Bowyer Master]";
		mes "How is the hunt going? Did you bring me any wood?";
		if (countitem(569) < 1) close;
		next;
		menu "Here, take a look!",L_State_3_try, "Yes, but I need it for something else.",-;
			close;
		L_State_3_try:
			mes "[Bowyer Master]";
			mes "Hmmm... looks ok, but is it strong enough?";
			mes "*bends the log over his knee*";
			next;
			delitem 569, 1;
			set @Temp1,rand(20);
			if (@Temp1 == 0) goto L_State_3_success;
				mes "(The log breaks with a loud crack)";
				next;
				mes "[Bowyer Master]";
				mes "Sorry, this log was too weak for one of my forest bows. Now it is junk. Give me another.";
				if (countitem(569) < 1) close;
				next;
				menu "Sure, here you go.",L_State_3_try, "Hey! Stop breaking my stuff!",-;
					close;

		L_State_3_success:
			mes "(The bowyer master tries as hard as he can but the log won't bend.)";
			next;
			mes "[Bowyer Master]";
			mes "Aaah! Yes! That is a really fine piece of wood you bought me. It will make an excelent bow!";
			next;
			set QUEST_Forestbow_state, 4;

	L_State_4:
			mes "I can make you a really nice forest bow out of this. I just need 10.000 gp for material and work time.";
			next;
			menu "10.000??? What a ripoff!",-,"Sure, here you go!", L_State_4_pay;
				close;
			L_State_4_pay:
				if (zeny < 10000) goto L_State_4_nocash;
					set zeny, zeny-10000;
					getitem 545, 1;
					set QUEST_Forestbow_state, 5;
					mes "Here you go - have fun with it.";
					close;
				L_State_4_nocash:
					mes "Seems like you are out of cash.";
					close;
	L_State_5:
			mes "I hope you are statisfied with your forest bow. It is one of my best works.";

}


// Lumberjack
new_19-1.gat,40,45,0	script	Jack	141, {

	if (QUEST_Forestbow_state > 1) goto L_State_2;

	mes "[Jack Lumber]";
	mes "Hello there, my name is Jack Lumber, the enemy of all trees. When you need some firewood just let me know.";
	if (QUEST_Forestbow_state < 1) close;

	next;
	menu "I heard you aren't delivering any more living wood. Why that?",-;

	mes "[Jack Lumber]";
	mes "Why not?! I value my life, that's why!.";

	next;
	menu "What do you mean?",-;

	mes "[Jack Lumber]";
	mes "A week ago I was going to chop down one of those twigleaf trees in the forest to the southwest. These twigleafs are the trees that give me the living wood you speak of. I was just chopping away with my axe and what happened? One of its branches hit me! I thought it fell down or the wind blew it. It hurt! I shook it off and struck it again with my axe and another branch hit me! I got angry and started to chop off all the branches near the ground so this couldn't happen anymore. But I still can't believe what happened next.";

	next;
	menu "What happened? ",-;

	mes "[Jack Lumber]";
	mes "You'll think I am insane when I tell you.";

	next;
	menu "I won't. I promise.",-;

	mes "[Jack Lumber]";
	mes "OK. After I chopped off a few branches the whole tree started to move. Its roots tore out of the earth, all the branches started to wave around and a face appeared on the trunk. The whole tree CAME TO LIFE! It was mad!";
	next;
	menu "Did you run away?",-,"Did you fight it?",-;

	mes "[Jack Lumber]";
	mes "I fought, of course! I took my axe and attacked the beast! It hit me here *points at a bruise at his shoulder*, here *lifts his trouser leg to show another bruise* and here *lifts his shirt and reveals some even worse bruises*. But i didn't give up. I chopped away at it, branch after branch, and in the end I chopped off its roots and it fell to the ground motionless. ";

	next;
	menu "So you beat the monster? Then why are you so scared?";

	mes "[Jack Lumber]";
	mes "Well, I was exhausted and had to rest. A few minutes passed and suddenly I was surrounded by a dozen or more of these living trees!";

	next;
	menu "Did you fight them, too? ",-;

	mes "[Jack Lumber]";
	mes "Are you crazy? I barely destroyed one of those beasts. I was in no shape to fight again. I ran away as fast as i could. Lucky for me the monsters aren't that fast on their tiny root legs. Ha! ";

	next;
	menu "So you aren't chopping down trees anymore? ",-;

	mes "[Jack Lumber]";
	mes "I still do. It's my job. But I no longer chop those twigleafs, I'll tell you that. I know the bowyer master wants some wood from them, but I don't care. I won't risk my life for a few gold pieces. If you want to, just go to the southwest. But i won't go there ever again.";

	next;
	menu "Southwest you say? OK, thank you.",-;

	set QUEST_Forestbow_state, 2;
	close;

	L_State_2:
		mes "Good luck hunting those tree monsters - you will need it.";
		close;
}
