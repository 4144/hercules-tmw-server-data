033-1.gat,66,28,0|script|Yerrnk|216,{
//TODO: minimum level for quests?
    set @Q_Barbarians_MASK, NIBBLE_0_MASK;
    set @Q_Barbarians_SHIFT, NIBBLE_0_SHIFT;

    set @state, ((QUEST_Barbarians & @Q_Barbarians_MASK) >> @Q_Barbarians_SHIFT);

    if (@state == 6) goto L_Warrior;
    if (@state == 5) goto L_Birrod;
    if (@state == 4) goto L_Sorrow;
    if (@state == 3) goto L_Duty;
    if (@state == 2) goto L_Kimarr;
    if (@state == 1) goto L_Fluffy;

    mes "[Barbarian]";
    mes "\"Hello. I'm Yerrnk, first warrior of the Mangarr.\"";
    next;
    mes "Yerrnk looks at you in a reserved way.";
    mes "[Yerrnk]";
    mes "\"Please take care of your own business.\"";
    close;

L_Fluffy:
    mes "[Yerrnk]";
    mes "\"Kimarr talks too much sometimes.\"";
    mes "He sighs.";
    next;
    mes "[Yerrnk]";
    mes "\"Are you going to accept Kimarr's task? It's an ancient ceremony in our tribe. A young member is accepted as an adult when completing it.\"";
    close;

L_Kimarr:
    mes "[Yerrnk]";
    mes "\"I think Kimarr wants to give you something.\"";
    close;

L_Duty:
    mes "[Yerrnk]";
    mes "\"I'm not sure if you are aware about the meaning of your actions.\"";
    next;
    mes "\"You passed the inition ritus for hunters of our tribe. That means now you are a hunter of our tribe, with all the rights and duties that come along with that.\"";
    next;
    mes "\"So you'll have to obey our laws and traditiones, protect and help any member of our tribe that is in need and never show weakness nor fear in battle.\"";
    next;
    mes "\"Keep this in mind. If you fail you'll have to recieve the elders judgement.\"";
    close;

L_Sorrow:
    mes "[Yerrnk]";
    mes "\"I noticed that you're getting along with Kimarr and Birrod very well. That's good.\"";
    mes "He smiles, but then an expression of worry gets back to his face.";
    next;
    mes "[Yerrnk]";
    mes "\"Our tribe is going through dire straits. We used to live in harmony with the mountain ever since.";
    mes "Life is hard in the snowy mountains, but this life suits our nature.\"";
    next;
    mes "\"But some weeks ago the Yetis started to act very strange. Usually they are very shy, but now...";
    mes "They left the secluded areas high up in the mountains they used to live on and started roaming our hunting grounds.\"";
    next;
    mes "\"It became very dangerous to leave the village, so it's even harder to gather enough food to survive.";
    mes "But not only this, the Yetis are getting more daring every day - they might attack the village itself sooner or later.\"";
    next;
    mes "\"Other wild animals got more aggressive as well, though the Yetis are the most dangerous.";
    mes "Something like that has never happened before. We have no idea what could cause the animals to behave like this.\"";
    next;
    mes "\"That's why we were sent on a mission to find and talk to Santa, one of the Sages of Kazei.";
    mes "The Sages are wizards of great power and wisdom, and we hope Santa might be able to give us advice.\"";
    close;

L_Birrod:
    mes "[Yerrnk]";
    mes "\"" + strcharinfo(0) + ", I have to admit that I'm surprised by your skills.";
    mes "You've proved your braveness and strength.\"";
    if (getskilllv(SKILL_POOL) == 0) goto L_Not_Ready;
    mes "\"Please talk to Birrod to receive the initiation ritual to become a warrior of the Mangarr.\"";
    close;

L_Not_Ready:
    mes "[Yerrnk]";
    mes "\"But you're not yet ready to become a fully accepted warrior of our tribe.";
    mes "You should travel the world to gain the ability to focus on your inner strength.\"";
    close;

L_Warrior:
//TODO: player is now fully accepted warrior of the tribe, gets a task: bring yeti claws
// reason: claws can be used to craft spears which are effective to use against the yetis
    mes "TODO: add story about bringing yeti claw (probably final quest)";
    close;

S_Update_Mask:
        set QUEST_Barbarians,
            (QUEST_Barbarians & ~(@Q_Barbarians_MASK))
                | (@state << @Q_Barbarians_SHIFT);
        return;
}
